<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
<!--
        <record id="purchase_request" model="workflow">
            <field name="name">Purchase Request Basic Workflow</field>
            <field name="osv">purchase.request</field>
            <field name="on_create">True</field>
        </record>
       
        <record id="act_draft" model="workflow.activity">
            <field name="wkf_id" ref="purchase_request"/>
            <field name="flow_start">True</field>
            <field name="name">draft</field>
        </record>
        <record id="act_wait_approval" model="workflow.activity">
            <field name="wkf_id" ref="purchase_request"/>
            <field name="name">wait_approval</field>
            <field name="kind">function</field>
            <field name="action">write({'state':'wait_approval'})</field>
        </record>
        <record id="act_approved" model="workflow.activity">
            <field name="wkf_id" ref="purchase_request"/>
            <field name="name">approved</field>
            <field name="kind">function</field>
            <field name="action">write({'state':'approved'})</field>
        </record>
        <record id="act_disapproved" model="workflow.activity">
            <field name="wkf_id" ref="purchase_request"/>
            <field name="name">disapproved</field>
            <field name="kind">function</field>
            <field name="action">wkf_disapprove()</field> 
        </record>	     
        <record id="act_ordered" model="workflow.activity">
            <field name="wkf_id" ref="purchase_request"/>
            <field name="name">ordered</field>
            <field name="kind">function</field>
            <field name="action">write({'state':'ordered'})</field>
            <field name="flow_stop">True</field>
        </record>      
-->
		<!--{{{ roles-->
		<record id="res_roles_pr_user" model="res.roles">
		    <field name="name">Purchase Request User</field>
		</record>
		
		<record id="res_roles_pr_head" model="res.roles">
		    <field name="name">Purchase Request Head</field>
		</record>
		
		<record id="res_roles_pr_manager" model="res.roles">
		    <field name="name">Purchase Request Manager</field>
		</record>
		<!--}}}-->
		
		<!--{{{ purchase.request -->
		<record id="wkf_pr" model="workflow">
		    <field name="name">Purchase Request</field>
		    <field name="osv">purchase.request</field>
		    <field name="on_create">True</field>
		</record>
		
		<!--{{{ activity -->
		<record id="wka_draft" model="workflow.activity">
		    <field name="wkf_id" ref="wkf_pr"/>
		    <field name="name">draft</field>
		    <field name="flow_start">True</field>
		    <field name="kind">function</field>
		    <field name="action">wkf_draft()</field>
		</record>
		
		<record id="wka_wait_approval" model="workflow.activity">
		    <field name="wkf_id" ref="wkf_pr"/>
		    <field name="name">wait_approval</field>
		    <field name="kind">function</field>
		    <field name="action">wkf_wait_approval()</field>
		</record>
		<!--
		<record id="wka_wait_warehouse" model="workflow.activity">
		    <field name="wkf_id" ref="wkf_pr"/>
		    <field name="name">wait_warehouse</field>
		    <field name="kind">function</field>
		    <field name="action">wkf_wait_warehouse()</field>
		</record>
		-->
		<record id="wka_approved" model="workflow.activity">
		    <field name="wkf_id" ref="wkf_pr"/>
		    <field name="name">approved</field>
		    <field name="kind">function</field>
		    <field name="action">wkf_approved()</field>
		</record>
		
		<record id="wka_disapproved" model="workflow.activity">
		    <field name="wkf_id" ref="wkf_pr"/>
		    <field name="name">disapproved</field>
		    <field name="kind">function</field>
		    <field name="action">wkf_disapproved()</field>
		</record>
		
		<record id="wka_ordered" model="workflow.activity">
		    <field name="wkf_id" ref="wkf_pr"/>
		    <field name="name">ordered</field>
		    <field name="kind">function</field>
		    <field name="action">wkf_ordered()</field>
		</record>
		
		<record id="wka_received" model="workflow.activity">
		    <field name="wkf_id" ref="wkf_pr"/>
		    <field name="name">received</field>
		    <field name="flow_stop">True</field>
		    <field name="kind">function</field>
		    <field name="action">wkf_received()</field>
		</record>
		
		<record id="wka_canceled" model="workflow.activity">
		    <field name="wkf_id" ref="wkf_pr"/>
		    <field name="name">canceled</field>
		    <field name="flow_stop">True</field>
		    <field name="kind">function</field>
		    <field name="action">wkf_canceled()</field>
		</record>
		<!--}}}-->
		
		<!--{{{ transition -->
		<record id="wkt_draft_send_head" model="workflow.transition">
		    <field name="act_from" ref="wka_draft"/>
		    <field name="act_to" ref="wka_wait_head"/>
		    <field name="signal">button_send_head</field>
		    <field name="role_id" ref="res_roles_pr_user"/>
		</record>
		
		<record id="wkt_approve_head" model="workflow.transition">
		    <field name="act_from" ref="wka_wait_head"/>
		    <field name="act_to" ref="wka_wait_warehouse"/>
		    <field name="signal">button_approve_head</field>
		    <field name="role_id" ref="res_roles_pr_head"/>
		</record>
		
		<record id="wkt_approve_warehouse" model="workflow.transition">
		    <field name="act_from" ref="wka_wait_warehouse"/>
		    <field name="act_to" ref="wka_approved"/>
		    <field name="signal">button_approve_warehouse</field>
		    <field name="role_id" ref="res_roles_pr_manager"/>
		</record>
		
		<record id="wkt_disapprove_head" model="workflow.transition">
		    <field name="act_from" ref="wka_wait_head"/>
		    <field name="act_to" ref="wka_disapproved"/>
		    <field name="signal">button_disapprove_head</field>
		    <field name="role_id" ref="res_roles_pr_head"/>
		</record>
		
		<record id="wkt_disapprove_warehouse" model="workflow.transition">
		    <field name="act_from" ref="wka_wait_warehouse"/>
		    <field name="act_to" ref="wka_disapproved"/>
		    <field name="signal">button_disapprove_warehouse</field>
		    <field name="role_id" ref="res_roles_pr_manager"/>
		</record>
		
		<record id="wkt_ordered" model="workflow.transition">
		    <field name="act_from" ref="wka_approved"/>
		    <field name="act_to" ref="wka_ordered"/>
		    <field name="condition">test_state('ordered')</field>
		</record>
		
		<record id="wkt_not_ordered" model="workflow.transition">
		    <field name="act_from" ref="wka_ordered"/>
		    <field name="act_to" ref="wka_approved"/>
		    <field name="condition">not test_state('ordered')</field>
		</record>
		
		<record id="wkt_received" model="workflow.transition">
		    <field name="act_from" ref="wka_ordered"/>
		    <field name="act_to" ref="wka_received"/>
		    <field name="condition">test_state('received')</field>
		</record>
		
		<record id="wkt_received2" model="workflow.transition">
		    <field name="act_from" ref="wka_approved"/>
		    <field name="act_to" ref="wka_received"/>
		    <field name="condition">test_state('received')</field>
		</record>
		
		<record id="wkt_to_draft" model="workflow.transition">
		    <field name="act_from" ref="wka_disapproved"/>
		    <field name="act_to" ref="wka_draft"/>
		    <field name="signal">button_draft</field>
		    <field name="role_id" ref="res_roles_pr_user"/>
		</record>
		
		<record id="wkt_canceled1" model="workflow.transition">
		    <field name="act_from" ref="wka_draft"/>
		    <field name="act_to" ref="wka_canceled"/>
		    <field name="signal">button_cancel</field>
		</record>
		<!--}}}-->
		<!--}}}-->
		
		<record id="mrp.act_buy" model="workflow.activity">
		    <field name="kind">function</field>
		    <field name="action">make_pr()</field>
		</record>
		
		<record id="mrp.trans_buy_make_done" model="workflow.transition">
		    <field name="signal"></field>
		</record>
	
	</data>
</openerp>
